---
import { fetchApi } from "../lib/strapi";
import { Image } from "astro:assets";

interface StudioHeroData {
  title: string;
  description: string;
  image: {
    url: string;
    alternativeText: string;
  };
}

let data;
try {
  data = await fetchApi<StudioHeroData>({
    endpoint: "studio-hero",
    query: "populate=*",
  });
} catch (e) {
  data = null;
}

if (!data) {
  data = {
    title: "Nasze Studio",
    description: "Przestrzeń stworzona z myślą o Twoim komforcie i skupieniu.",
    image: {
      url: "https://images.unsplash.com/photo-1518459031867-a89b944bffe4?auto=format&fit=crop&q=80&w=1910",
      alternativeText: "Abstract clean pilates studio space",
    },
  };
}

const strapiUrl = import.meta.env.STRAPI_URL || "";
const imageUrl = data.image.url.startsWith("http")
  ? data.image.url
  : `${strapiUrl}${data.image.url}`;
---

<header
  class="relative h-[60vh] md:h-[70vh] flex items-center justify-center overflow-hidden"
>
  <div class="absolute inset-0 z-0">
    <Image
      src={imageUrl}
      alt={data.image.alternativeText}
      width={1920}
      height={1080}
      loading="eager"
      class="w-full h-full object-cover opacity-90 dark:opacity-60"
    />
    <div
      class="absolute inset-0 bg-primary/20 dark:bg-background-dark/70 mix-blend-multiply"
    >
    </div>
  </div>
  <div class="relative z-10 text-center px-4 max-w-7xl mx-auto animate-fade-in">
    <h1 class="text-5xl md:text-7xl font-display text-white mb-6 tracking-wide">
      {data.title}
    </h1>
    <p
      class="text-lg md:text-xl text-white/90 font-light tracking-wide max-w-2xl mx-auto leading-relaxed"
    >
      {data.description}
    </p>
  </div>
</header>
