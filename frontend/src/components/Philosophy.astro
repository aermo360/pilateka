---
import { fetchApi } from "../lib/strapi";
import { Image } from "astro:assets";

interface PhilosophyData {
  label: string;
  title: string;
  description1: string;
  description2: string;
  image: {
    url: string;
    alternativeText: string;
  };
}

let data;
try {
  data = await fetchApi<PhilosophyData>({
    endpoint: "philosophy",
    query: "populate=*",
  });
} catch (e) {
  data = null;
}

if (!data) {
  data = {
    label: "NASZA FILOZOFIA",
    title: "Uważny ruch dla równowagi w życiu.",
    description1:
      "Joseph Pilates stworzył swój system ćwiczeń przede wszystkim w celu usprawniania i polepszania jakości życia – i dokładnie w ten sposób podchodzę do prowadzonych przeze mnie treningów. Niezależnie od tego, czy chcesz wrócić do sprawności po kontuzji, bezpiecznie ćwiczyć w ciąży, szukasz mobilności potrzebnej na boisku lub korcie czy po prostu szukasz mądrego, jakościowego ruchu, który pomoże Ci budować sprawność – w kameralnej przestrzeni Pilateki możemy wspólnie znaleźć rozwiązanie.",
    description2: "",
    image: {
      url: "https://images.unsplash.com/photo-1518310383802-640c2de311b2?auto=format&fit=crop&q=80&w=800",
      alternativeText:
        "Minimalistyczne wnętrze studia pilates z naturalnym światłem",
    },
  };
}

const strapiUrl = import.meta.env.STRAPI_URL || "";
const imageUrl = data.image.url.startsWith("http")
  ? data.image.url
  : `${strapiUrl}${data.image.url}`;
---

<section
  class="py-24 bg-background-light dark:bg-surface-dark transition-colors duration-300"
  id="studio"
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-16 items-center">
      <div class="space-y-6">
        <span
          class="text-primary dark:text-gray-400 text-[10px] uppercase tracking-[0.4em] font-bold block mb-6 px-1"
          >{data.label}</span
        >
        <h3
          class="text-4xl md:text-5xl font-display text-primary dark:text-white leading-tight mb-10 text-pretty"
        >
          {data.title}
        </h3>
        <div class="space-y-6">
          <p
            class="text-gray-500 dark:text-gray-400 leading-relaxed font-light text-lg whitespace-pre-line"
          >
            {data.description1}
          </p>
        </div>
      </div>
      <div
        class="relative h-96 md:h-[500px] w-full bg-gray-200 dark:bg-gray-800 overflow-hidden shadow-xl"
      >
        <Image
          src={imageUrl}
          alt={data.image.alternativeText}
          width={800}
          height={1000}
          class="w-full h-full object-cover transform hover:scale-105 transition-transform duration-700"
        />
      </div>
    </div>
  </div>
</section>
